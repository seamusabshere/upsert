sudo: required
dist: trusty
language: ruby
global:
  - USERNAME=travis
    PASSWORD=
addons:
  apt:
    packages:
    - mysql-server-5.6
    - mysql-client-core-5.6
    - mysql-client-5.6
rvm:
  - 2.3
  - 2.2
  - 2.1
  - 1.9.3
  - rbx-2
  - jruby-1.7
  - jruby-9
matrix:
  allow_failures:
    - rvm: rbx-2
env:
  - DB=postgresql PGVERSION=9.4
  - DB=postgresql PGVERSION=9.5
  - DB=postgresql PGVERSION=9.4 UNIQUE_CONSTRAINT=true
  - DB=postgresql PGVERSION=9.5 UNIQUE_CONSTRAINT=true
  - DB=mysql DB_USER=root
before_install:
  - if [ '$DB' = 'postgresql' ]; then ./travis/install_postgres.sh; fi
  - gem update bundler
  - bundle --version
  - gem update --system 2.1.11
  - gem --version
script: bundle exec rake spec
