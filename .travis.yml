sudo: required
dist: trusty
language: ruby
global:
  - USERNAME=travis
    PASSWORD=
addons:
  apt:
    packages:
    - mysql-server-5.6
    - mysql-client-core-5.6
    - mysql-client-5.6
rvm:
  - 2.3
  - 2.2
  - 2.1
  - 1.9.3
  - rbx-2
matrix:
  allow_failures:
    - rvm: rbx-2
env:
  - DB=postgresql94
  - DB=postgresql95
  - DB=postgresql94 UNIQUE_CONSTRAINT=true
  - DB=postgresql95 UNIQUE_CONSTRAINT=true
  - DB=mysql DB_USER=root
before_install:
  - sh -c "if [ '$DB' = 'postgresql94' ]; then sudo apt-get uninstall postgresql; sudo apt-get install postgresql-9.4; fi"
  - sh -c "if [ '$DB' = 'postgresql95' ]; then sudo apt-get uninstall postgresql; sudo apt-get install postgresql-9.5; fi"
  - gem update bundler
  - bundle --version
  - gem update --system 2.1.11
  - gem --version
script: bundle exec rake spec
